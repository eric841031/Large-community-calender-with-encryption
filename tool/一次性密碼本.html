<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>標題</title>
<style type="text/css">
table{border-collapse: collapse;}
td,th{border:1px solid;}
</style>
<script type="text/javascript" src="pwd.js"></script>
<script type="text/javascript" >
var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";
var txt1,txt2,img,can,dl,st;
function trans()
{
	dl.removeAttribute("href");
	img.src=txt2.value;
	st=document .getElementById("cb").checked;
}
function trans_go_on()
{
	var B=getImgData();
	var M=B.length>>2;
	var N=parseInt(txt1.value);	
	var r="",t1,t2;
	var dbg="pic_pwd=[";
	for(var i=0;i<N;++i)
	{
		t1=Math.floor(M*Math.random())<<2;
		t2=Math.floor(M*Math.random())<<2;
		t1=(B[t1]&1)|(B[t1+1]&1)<<1|(B[t1+2]&1)<<2|(B[t2]&1)<<3|(B[t2+1]&1)<<4|(B[t2+2]&1)<<5;
		dbg+=(i?",":"")+t1;
		r+=A[(Math.floor(64*Math.random())+t1)%64];
	}
	dbg+="];";
	var url = URL.createObjectURL(new Blob(['pwd="'+r+'";'+(st?"\n"+dbg:"")]));
	dl.setAttribute("href",url);
	dl.setAttribute("download","pwd.js");
}
function getImgData()
{
	var w=can.width=img.naturalWidth;
   var h=can.height=img.naturalHeight;
	var ctx=can.getContext("2d");
	ctx.drawImage(img,0,0);
	var a=ctx.getImageData(0,0,w,h).data;
   return a;
}
function init()
{
	txt1=document .getElementById("txt1");
	txt2=document .getElementById("txt2");
	img=document .getElementById("img1");
	can=document .getElementById("canvas1");
	dl=document .getElementById("dl");
}
</script>
</head>
<body onload="init()">
希望產生的密鑰長度(幾個Base64碼)<input id="txt1" type="text"><br>
擾亂用圖檔:<input id="txt2" type="text"><button onclick="trans()">建立</button>
(with<input type="checkbox" id="cb">dbg)
<a id="dl">下載</a>
<div><!-- style="display:none;"-->
<img id="img1" onload="trans_go_on()">
<canvas id="canvas1"></canvas>
</div>
</body>
</html>


